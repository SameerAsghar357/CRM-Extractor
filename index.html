<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>CRM Booking Extractor</title>
  <link rel="icon" type="image/png" href="/favicon.png">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
      background-color: #024950;
      color: #ffffff;
    }
    textarea {
      width: 100%;
      height: 150px;
      font-family: monospace;
      background-color: #003135;
      color: #ffffff;
      border: none;
      padding: 10px;
    }
    pre {
      background: #003135;
      padding: 10px;
      white-space: pre-wrap;
      color: #ffffff;
    }
    button {
      margin-top: 10px;
      padding: 8px 12px;
      font-size: 14px;
      background-color: #0FAA4F;
      border: none;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #0d8a40;
    }
  </style>
</head>
<body>
  <h2>CRM Booking Extractor</h2>
  <p>Paste your CRM lines below (one per line):</p>
  <textarea id="input" placeholder="Paste CRM lines here..."></textarea><br><br>

  <h3>Formatted Output:</h3>
  <pre id="output"></pre>
  <button onclick="copyOutput()">Copy Output</button>

  <script>
    const inputBox = document.getElementById("input");
    const outputBox = document.getElementById("output");

    inputBox.addEventListener("input", () => {
      const input = inputBox.value.trim();
      const lines = input.split("\n");
      const result = [];

      lines.forEach(line => {
        const parts = line.trim().split(/\t| {2,}|\s(?=\d{2}-[A-Za-z]{3}-\d{4})/); // split by tab, multiple spaces, or before date
        if (parts.length >= 8) {
          const bookingRef = parts[0];
          const name = parts[3];
          const carReg = parts[6];
          const phone = parts[7].replace(/\s+/g, "");
          result.push(`${bookingRef}\n${name}\n${carReg}\n${phone}\n`);
        } else {
          result.push("âŒ Invalid line: " + line + "\n");
        }
      });

      outputBox.textContent = result.join("\n");
    });

    function copyOutput() {
      const output = outputBox.textContent;
      navigator.clipboard.writeText(output).catch(err => {
        console.error("Copy failed", err);
      });
    }
  </script>
</body>
</html>
